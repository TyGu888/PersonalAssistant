# LLM 配置（火山引擎方舟）
llm:
  api_key: ${ARK_API_KEY}  # 从环境变量读取
  base_url: https://ark.cn-beijing.volces.com/api/v3
  model: ep-20260128095801-jc4gx  # 火山引擎模型端点

# 数据目录（SQLite + ChromaDB）
data:
  dir: ./data  # 会创建 sessions.db 和 chroma/

# Memory 配置
memory:
  max_context_messages: 20  # 上下文最大消息数（截断历史）

# Channel 配置
channels:
  cli:
    enabled: true   # CLI + Discord 同时启动
  telegram:
    enabled: false  # Phase 0 先关闭
    token: ${TELEGRAM_BOT_TOKEN}
    allowed_users: ["968804902337912883"]  # 白名单
  discord:
    enabled: true
    token: ${DISCORD_BOT_TOKEN}
    allowed_users: ["968804902337912883"]  # 白名单

# 路由规则（按顺序匹配，第一个匹配生效）
routing:
  - match: {pattern: "学习|复习|督促"}
    agent: study_coach
    tools: [scheduler_add, scheduler_list]
  
  - match: {pattern: "搜索|查找|研究|调查|了解|访问|网页|抓取"}
    agent: default
    tools: [web_search, fetch_url, create_file, send_file]
  
  - match: {pattern: "执行|运行|命令|shell|git|npm|pip"}
    agent: default
    tools: [run_command]
  
  - match: {pattern: "创建|写入|读取|文件|目录|删除|追加|发送"}
    agent: default
    tools: [create_file, read_file, list_files, append_file, delete_file, send_file]
  
  - match: {pattern: "提醒|定时|闹钟|计划"}
    agent: default
    tools: [scheduler_add, scheduler_list, scheduler_cancel]
  
  - match: {}  # 兜底
    agent: default
    tools: [web_search, run_command, create_file, read_file, list_files, send_file, scheduler_add, scheduler_list, scheduler_cancel]

# Agent 定义
agents:
  study_coach:
    prompt: |
      你是一个严厉但关心学生的学习教练。
      督促用户学习，提醒完成任务。
      
      ## 处理定时任务触发
      当收到 [定时任务触发] 开头的消息时：
      1. 友好地提醒用户
      2. 设置下一次提醒（scheduler_add，auto_continue=True）
      3. 可选：设置1小时后的追问提醒（auto_continue=False）
  
  default:
    prompt: |
      你是一个友好的助手。
      
      ## 处理定时任务触发
      当收到 [定时任务触发] 开头的消息时：
      1. 友好地提醒用户该做的事
      2. 设置下一次提醒（scheduler_add，auto_continue=True，默认明天同一时间）
      3. 可选：设置1小时后的追问提醒（auto_continue=False）
